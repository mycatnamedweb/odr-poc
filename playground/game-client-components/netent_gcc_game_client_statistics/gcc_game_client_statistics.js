/*! netent_gcc_game_client_statistics : 0.0.5 - Wed, 03 Jul 2019 14:19:04 GMT | (c) 2019  NetEnt AB (publ) | ISC | https://www.netent.com/ */!function(n){var s={};function i(t){if(s[t])return s[t].exports;var e=s[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,i),e.l=!0,e.exports}i.m=n,i.c=s,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(n,s,function(t){return e[t]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=2)}([function(t,e){t.exports=netent_gcc_shared},function(t,e,n){"use strict";var s=this&&this.__assign||Object.assign||function(t){for(var e,n=1,s=arguments.length;n<s;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t};Object.defineProperty(e,"__esModule",{value:!0});var i,o=n(0);(i=i||{}).GCS_GAME_READY="GCS_GAME_READY";var r=(a.prototype.init=function(){this.logger.log("Initializing StatisticsController"),this.EventMed.listen(this.Constants.GCC.ENABLE_STATISTICS,this.enable.bind(this)),this.EventMed.listen(this.Constants.GCC.DISABLE_STATISTICS,this.disable.bind(this)),this.EventMed.listen(this.Constants.STATISTICS.LOAD_STATISTICS,this.sendLoadStats.bind(this)),this.EventMed.listen(this.Constants.STATISTICS.PLAYER_STATISTICS,this.sendPlayerStats.bind(this)),this.EventMed.listen(this.Constants.Game.GAME_RESOURCES_RESPONSE,this.gameResources.bind(this))},a.prototype.enable=function(t){this.config=t.detail},a.prototype.disable=function(){this.config=void 0},a.prototype.sendLoadStats=function(t){var e=this;this.config?this.makeRequest(this.config.statisticEndpointURL,"POST",this.prepareData(i.GCS_GAME_READY,t.detail)).then(function(){e.logger.log("Statistics sent to server")}):this.logger.log("Statistics is not enabled or configured properly")},a.prototype.sendPlayerStats=function(t){var e=this;this.config?this.makeRequest(this.config.statisticEndpointURL,"POST",t.detail).then(function(){e.logger.log("Statistics sent to server")}):this.logger.log("Statistics is not enabled or configured properly")},a.prototype.makeRequest=function(n,s,i){var o=new XMLHttpRequest;return new Promise(function(t,e){o.onreadystatechange=function(){4===o.readyState&&(200<=o.status&&o.status<300?t(o):e({status:o.status,statusText:o.statusText}))},o.open(s,n,!0),"POST"===s&&i?(o.setRequestHeader("Content-Type","application/json"),o.send(JSON.stringify(i))):o.send()})},a.prototype.gameResources=function(t){this.gameId=t.detail.gameID,this.casinoId=t.detail.casinoID},a.prototype.prepareData=function(t,e){return this.logsId=e.logsId?e.logsId:this.logsId?this.logsId:this.generateUUID(),delete e.logsId,{casinoId:this.casinoId,data:s({gameId:this.gameId,logsId:this.logsId,loadSeqNo:Date.now(),logSeqNo:Date.now()},e),dateOccurred:(new Date).toISOString(),eventId:this.generateUUID(),name:t,version:"2.0"}},a.prototype.generateUUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})},a);function a(){this.logger=o.netent_gcc_shared.ConsoleLogger,this.EventMed=o.netent_gcc_shared.EventsMediator,this.Constants=o.netent_gcc_shared.AppConstants,this.init()}e.StatisticsController=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n(0).netent_gcc_shared.EventsMediator,i=new(n(1).StatisticsController);s.listen("reset",function(){i.init()})}]);